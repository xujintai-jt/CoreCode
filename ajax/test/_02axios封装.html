<!--
 * @Author: xujintai
 * @Date: 2021-01-27 15:37:16
 * @LastEditors: xujintai
 * @LastEditTime: 2021-01-27 17:53:43
 * @Description: file content
 * @FilePath: \CoreCode\ajax\test\_02axios封装.html
-->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <script>
    function axios({
      url,
      method = "GET",
      data = {},
      params = {}
    }) {
      //返回一个Promise对象
      return new Promise((resolve, reject) => {
        // 1. 发起异步ajax请求
        const xmlhttp = new XMLHttpRequest()
        //打开连接
        xmlhttp.open(method, url, true);
        //发送请求(判断请求方式)
        if (method === 'GET') {
          xmlhttp.send();
        } else if (method === 'POST') {
          xmlhttp.setRequestHeader("Content-Type", "application/json;charset=utf-8") //告诉服务器,请求体的格式是json
          xmlhttp.send(JSON.stringify(data)); //发送json格式的请求体参数(发送json格式请求体需要设置请求头)
        }


        // 2.1 发送请求成功

        // 2.2 发送请求失败
      })
    }

    //axios(config)
    axios({
      method: 'POST',
      url: 'http://localhost:3000/posts',
      data: {
        firstName: 'Fred',
        lastName: 'Flintstone'
      }
    });

    // axios({
    //   url: 'http://localhost:3000/posts',
    //   params: {
    //     id: 1
    //   }
    // });
  </script>

</body>

</html>